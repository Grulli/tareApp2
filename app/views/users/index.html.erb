<h1>Usuarios</h1>

<div id="accordion">
    <div class="accordion-group">
		<a data-toggle="collapse" data-parent="#accordion" href="#new_user">
            Crear nuevo usuario
        </a>
		<div id="new_user" class="accordion-body collapse">
			<br/>
			<%= form_tag(admin_create_path, :method=>'post') do %>
				<div class="field">
					<%= label_tag(:email, "Correo electronico:") %>
					<%= text_field_tag(:email, nil, :required => true) %>
				</div>
				<div class="field">
					<%= label_tag(:name , "Nombre") %>
					<%= text_field_tag(:name, nil, :required => true) %>
				</div>
				<div class="field">
					<%= label_tag(:lastname, "Apellido" )%>
					<%= text_field_tag(:lastname, nil, :required => true)%>
				</div>
				<div class="field">
					<%= label_tag :admin, "Administrador"%>
					<%= check_box_tag :admin %>
				</div>
				<div class="field">
					<%= label_tag :password, "Contraseña" %>
					<%= password_field_tag :password, nil, :required => true %>
				</div>
				<div class="field">
					<%= label_tag :password_confirmation, "Confirmación de Contraseña" %>
					<%= password_field_tag :password_confirmation, nil, :required => true %>
				</div>
				<div class="actions">
					<%= submit_tag "Crear cuenta" %>
				</div>
			<% end %>
		</div>
	</div>
</div>

<ul class="nav nav-tabs">
	<% if !params[:status] %>
		<li class ="active">
	<% else %>
		<li>
	<% end %>
		<a href = <%= url_for(users_path) %> >Ver todos</a>
    </li>
	<% if params[:status] == "active" %>
		<li class ="active">
	<% else %>
		<li>
	<% end %>
		<a href = "/users_index/active" %>Ver activos</a>
	</li>
	<% if params[:status] == "deleted" %>
		<li class ="active">
	<% else %>
		<li>
	<% end %>
		<a href = "/users_index/deleted" %>Ver eliminados</a>
	</li>
</ul>

<table class="footable">
	<thead>
		<tr>
			<th data-class="expand">Correo Electronico</th>
		    <th data-hide="phone">Nombre</th>
		    <th data-hide="phone">Apellido</th>
			<th data-hide="phone,tablet">Activado</th>
		    <th data-hide="phone">Activo</th>
		    <th data-hide="phone">Administrador</th>
		    <th data-hide="phone,tablet">Última Fecha de Conexión</th>
		    <th data-hide="phone,tablet">Último Servidor de Conexión</th>
		    <th></th>
		</tr>
	</thead>
	<tbody>
		<% @users.each do |user| %>
	  		<tr>
			    <td><%= user.email %></td>
			    <td><%= user.name %></td>
			    <td><%= user.lastname %></td>
				<td>
					<% if user.active %>
						<i class="icon-ok"></i>
					<% else %>
						<i class="icon-remove"></i>
					<% end %>
				</td>
			    <td>
					<% if user.deleted == 0 %>
						<i class="icon-thumbs-up"></i>
					<% else %>
						<i class="icon-ban-circle"></i>
					<% end %>
				</td>
			    <td>
					<% if user.admin %>
						<i class="icon-ok"></i>
					<% else %>
						<i class="icon-remove"></i>
					<% end %>
				</td>
			    <td><%= user.last_login_date %></td>
			    <td><%= user.last_login_server %></td>
			    <td>
					<a href = <%= url_for(user) %> >
						<i class="icon-eye-open"></i>
					</a>
					<% if user.deleted == 0 %>
						<span>|</span>
						<a href = <%= url_for(edit_user_path(user)) %> >
							<i class="icon-pencil"></i>
						</a>
					<% end %>
					<% if user.deleted == 0 %>
						<span>|</span>
						<a href = <%= url_for(user) %> data-method="delete" class="delete_link">
							<i class="icon-trash"></i>
						</a>
					<% end %>
				</td>
	  		</tr>
		<% end %>
	</tbody>
</table>

<br />

<ul id="pagination" class="footable-nav"><span>Paginas:</span></ul>

<br />



<script type="text/javascript">
  	$(function() {
    	$('.footable').footable();
  	});
  
	$(".delete_link").click(function(e){
		if(!confirm('¿Seguro que desea eliminar?'))
		{
			e.preventDefault();
			return false;
		}
	});
  
</script>